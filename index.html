<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<!--
Author: Sai Vignesh Golla
LinkedIn: https://www.linkedin.com/in/saivigneshgolla
Version: 1.0.0
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Useless App</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml, %3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 36 36'%3E%3Cpath fill='%239A4E1C' d='M32 8h-6V4c0-2.209-1.791-4-4-4h-8c-2.209 0-4 1.791-4 4v4H4c-2.209 0-4 1.791-4 4v20c0 2.209 1.791 4 4 4h28c2.209 0 4-1.791 4-4V12c0-2.209-1.791-4-4-4zM12 6c0-1.104.896-2 2-2h8c1.104 0 2 .896 2 2v2H12V6z'/%3E%3Cpath fill='%23662113' d='M36 20c0 2.209-1.791 4-4 4H4c-2.209 0-4-1.791-4-4v-8c0-2.209 1.791-4 4-4h28c2.209 0 4 1.791 4 4v8z'/%3E%3Cpath fill='%239A4E1C' d='M36 18c0 2.209-1.791 4-4 4H4c-2.209 0-4-1.791-4-4v-6c0-2.209 1.791-4 4-4h28c2.209 0 4 1.791 4 4v6z'/%3E%3Cpath fill='%23CCD6DD' d='M22 18c0 1.104-.896 2-2 2h-4c-1.104 0-2-.896-2-2s.896-2 2-2h4c1.104 0 2 .896 2 2'/%3E%3C/svg%3E">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <style>
        .heading { 
            background-color: #4c0bce;
            color: white;
        }
        .w-10 { width: 10%; }
        .tab-border {
            border: 2px;
            border-color: #0d6efd;
            border-style: solid;
        }
    </style>
</head>

<body>
    <header class="nav-bar heading mb-4 p-2">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <h1>Welcome to Most Useless App üòê</h1>
                <h1 class="m-2" id="time"></h1>
                <button id="theme" class="btn btn-light" onclick="themeChanger()">‚òÄÔ∏è Light Theme</button>
            </div>
        </div>
        <script>
            let theme = localStorage.getItem("theme");
            if (theme != null) { document.documentElement.setAttribute("data-bs-theme", theme) }
            else if (window.matchMedia("(prefers-color-scheme: light)").matches) {
                document.documentElement.setAttribute("data-bs-theme", "light")
                theme = "light"
                localStorage.setItem("theme", theme)
            }
            if (theme === "light") {
                const themeBtn = document.getElementById("theme")
                themeBtn.innerHTML = "üåô Dark Theme"
                themeBtn.classList.replace("btn-light", "btn-dark")
            }
        </script>
    </header>
    <div class="container">
        <main>
            <header>
                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                    <li class="nav-item me-2" role="presentation">
                        <button class="nav-link col-12 tab-border" id="changeText" data-bs-toggle="pill" data-bs-target="#changeText-tab" type="button" role="tab" aria-controls="changeText-tab" aria-selected="true" onclick="localStorage.setItem('app', 'changeText')">Change Text Cases üî†üî°</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link col-12 tab-border active" id="calculateTime" data-bs-toggle="pill" data-bs-target="#calculateTime-tab" type="button" role="tab" aria-controls="calculateTime-tab" aria-selected="false" onclick="localStorage.setItem('app', 'calculateTime')">Balance Work & Life üßòüèº‚Äç‚ôÇÔ∏èüè¢</button>
                    </li>
                </ul>
                <hr>
            </header>
            <div class="tab-content" id="pills-tabContent">
                <!-- CHANGE TEXT CASES -->
                <div class="tab-pane fade" id="changeText-tab" role="tabpanel" aria-labelledby="changeText" tabindex="0">
                    <h2>Did you accidentally type in wrong case ü§≠?</h2>
                    <p>No problem. Just enter the text you want to change and select the respective case changing button you want your text in.</p>
                    <br>
                    <label class="form-label" for="text">Enter your text in below box...</label>
                    <textarea class="form-control mb-3 p-1" id="text" name="text" oninput="dynamicHeight('text')"></textarea>
                    <div class="d-flex">
                        <button onclick="upper()" class="btn btn-primary me-3">ALL UPPERCASE</button>
                        <button onclick="lower()" class="btn btn-primary me-3">all lowercase</button>
                        <button onclick="startUpper()" class="btn btn-primary me-3">First Letters Of Words Upper</button>
                        <button onclick="reset()" class="btn btn-danger">Reset Text üóëÔ∏è</button>
                    </div>
                    <br>
                    <br>
                    <div class="d-flex justify-content-between align-items-end">
                        <label for="result" class="form-label">Your Modified Text is below...</label>
                        <button onclick="copyClipboard()" type="button" class="btn btn-success mb-2">Copy to Clipboard üìã</button>
                    </div>
                    <textarea class="form-control mb-3 p-1" name="result" id="result" readonly></textarea>
                    
                </div>

                <!-- PREPLAN LEAVING TIME TAB -->
                <div class="tab-pane fade show active" id="calculateTime-tab" role="tabpanel" aria-labelledby="calculateTime" tabindex="0">
                    <div class="d-flex justify-content-between">
                        <h2 class="flex-lg-fill me-2">Your Work-Life balance timings üï∞Ô∏è</h2>
                        <button class="btn btn-danger mb-1 flex-lg-fill" type="button" onclick="resetAll()" style="max-width: fit-content;">Reset to Default üìÜ</button>
                        <div class="flex-lg-fill"></div>
                    </div>
                    <p>Do you want to maintain a good work life balance, meet office hours? You can make your life easy by calculating when you would complete your regular hours. Just answer the required questions.</p>
                    <br>

                    <label for="startTime" class="form-label">When did you enter office?</label>
                    <div class="d-flex">
                        <input id="startTime" type="time" class="form-control w-25 p-1" value="08:00"
                        onfocus="this.previousValue = this.value"
                        onkeydown="this.previousValue = this.value"
                        oninput="calLeaveTime(); time24('startTime', this)">
                        <p id="startTime-24" class="m-2">08:00 Military time</p>
                    </div>
                    <br>

                    <label for="targetHrs" class="form-label">How many hours are you planning to work for (Work hrs) ‚è≥?</label>
                    <div class="d-flex ">
                        <input id="targetHrs" type="number" class="form-control w-10 p-1" value="8" min="0" max="12" step="1"
                        onfocus="this.previousValue = this.value"
                        onkeydown="this.previousValue = this.value"
                        oninput="validity.valid || (value = this.previousValue); if(value === null || value === undefined || value === '') {value = '0'}; calLeaveTime();">
                        <p class="m-2">hrs</p>
                        <input id="targetMin" type="number" class="form-control w-10 p-1" value="00" min="0" max="59" step="1"
                        onfocus="this.previousValue = this.value"
                        onkeydown="this.previousValue = this.value"
                        oninput="validity.valid || (value = this.previousValue); if(value === null || value === undefined || value === '') {value = '0'}; calLeaveTime();">
                        <p class="m-2">min</p>
                    </div>
                    <br>
                    <label for="lunch" class="form-label">How much time are you planning to take lunch for ‚è±Ô∏è?</label><p id="suggestLunch"></p>
                    <div id="lunch" class="d-flex">
                        <div class="me-2">
                            <label for="lunchStart"><strong>From :</strong></label>
                            <input id="lunchStart" type="time" class="form-control" value="12:00" 
                            onfocus="this.previousValue = this.value"
                            onkeydown="this.previousValue = this.value"
                            oninput="changeTo(); time24('lunchStart', this)">
                            <p id="lunchStart-24" class="mx-2 mt-1">12:00 Military time</p>
                        </div>
                        <div class="me-2">
                            <label for="lunchEnd"><strong>To :</strong></label>
                            <input id="lunchEnd" type="time" class="form-control" value="12:30"
                            onfocus="this.previousValue = this.value"
                            onkeydown="this.previousValue = this.value"
                            oninput="changeTotal(); time24('lunchEnd', this)">
                            <p id="lunchEnd-24" class="mx-2 mt-1">12:30 Military time</p>
                        </div>
                        <div class="me-2"><br><p class="py-1">=</p></div>
                        <div>
                            <label for="lunchTotal"><strong>Total :</strong></label>
                            <div class="d-flex">
                                <input id="lunchTotal" type="number" class="form-control" value="30" min="0" max="180" step="1"
                                onfocus="this.previousValue = this.value"
                                onkeydown="this.previousValue = this.value"
                                oninput="validity.valid || (value = this.previousValue); if(value === null || value === undefined || value === '') {value = '0'}; changeTo(); calLeaveTime()">
                                <p class="m-2">min</p>
                            </div>
                        </div>
                    </div>
                    <br>
                    <label for="leavingTime">From your inputs, your leaving time could be üöóüí®üè¢ </label>
                    <div class="d-flex mb-3">
                        <input id="leavingTime" type="time" class="form-control w-25 p-1 border-primary" value="16:30" readonly>
                        <p id="leavingTime-24" class="m-2">16:30 Military time</p>
                    </div>
                    <h3 id="timeLeft" class="mb-3"></h3>
                    <div id="result-warning" hidden>
                        <h3>‚ö†Ô∏è Well, That doesn't seem right ü§î!</h3>
                        <h3 id="result-error"></h3>
                    </div>
                </div>
            </div>
        </main>

        <!-- toast notification -->
        <div class="toast-container top-0 start-50 translate-middle-x p-3">
        <div id="toastMain" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
            <strong id="toastTitle" class="me-auto">‚ÑπÔ∏è Info</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div id="toastBody" class="toast-body">Invalid Input! Please use arrows and inbuilt buttons.</div>
        </div>
        </div>
    </div>

    <script>
        let app = localStorage.getItem("app")
        if (app === "changeText") {
            document.getElementById(app).classList.add("active")
            document.getElementById(app+"-tab").classList.add("show", "active")
            document.getElementById("calculateTime").classList.remove("active")
            document.getElementById("calculateTime-tab").classList.remove("show", "active")
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <script>
        // let app = localStorage.getItem("app")
        // if (app !== null) document.getElementById(app).click() 
        setInterval(timeLeft,1000)

        // App level functions
        function themeChanger() {
            const themeBtn = document.getElementById("theme")
            let theme = "light"
            if (themeBtn.innerHTML.search("Da") > -1) { theme = "dark" }
            localStorage.setItem("theme", theme)
            if (theme === "dark") {
                themeBtn.innerHTML = "‚òÄÔ∏è Light Theme"
                themeBtn.classList.replace("btn-dark", "btn-light")
            } else {
                themeBtn.innerHTML = "üåô Dark Theme"
                themeBtn.classList.replace("btn-light", "btn-dark")
            }
            document.documentElement.setAttribute("data-bs-theme", theme)
        }
        function showToast(message, title = "‚ÑπÔ∏è Info") {
            document.getElementById("toastBody").innerHTML = message
            document.getElementById("toastTitle").innerHTML = title
            bootstrap.Toast.getOrCreateInstance(document.getElementById("toastMain")).show()
        }
        function showWarning(message) {
            document.getElementById("result-warning").hidden = false
            document.getElementById("result-error").innerHTML = message
        }
        function hideWarning() { document.getElementById("result-warning").hidden = true }


        // Change Text Cases functions
        function reset() {
            let inputText = document.getElementById("text")
            inputText.value = ""
            inputText.setAttribute("rows", "1") 
        }
        function upper() {document.getElementById('result').innerHTML = document.getElementById("text").value.toUpperCase(); dynamicHeight('result')}
        function lower() {document.getElementById('result').innerHTML = document.getElementById("text").value.toLowerCase(); dynamicHeight('result')}
        function startUpper() {
            let list = document.getElementById("text").value.toLowerCase().split('\n')
            let text = ""
            for (sentence of list) {
                let words = sentence.split(' ')
                for (word of words) { text = text + word.charAt(0).toUpperCase() + word.substring(1) + " " }
                text = text.substring(0, text.length - 1) + "\n"
            }
            let resultText = document.getElementById('result')
            resultText.innerHTML = text.slice(0,-1)
            resultText.setAttribute("rows", list.length)
        }
        function copyClipboard() {
            let copyText = document.getElementById('result');
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(copyText.value);
            showToast("Copied the text: " + copyText.value);
        }
        function dynamicHeight(id) {
            let inputText = document.getElementById(id)
            let len = inputText.value.split('\n').length
            inputText.setAttribute("rows", len)
        }


        // Pre Plan Leaving Time functions
        let alerted = false
        function alertOnce() {
            if (!alerted) { alert("It's time!"); alerted = true; }
        }
        function timeCorrecter(hrs) { 
            if (Number(hrs) >= 24) { 
                let tomorrow = new Date(new Date() + (Number(hrs)-24)*60*60*1000)
                return [tomorrow.getHours(), "TOMORROW as in " + tomorrow + ""]
            } else { 
                return [hrs, ""] 
            } 
        }
        function timeLeft() {
            let currentTime = new Date()
            let leavingTime = document.getElementById("leavingTime").value.split(":")
            let timeLeft = (Number(leavingTime[0]) - currentTime.getHours())*60 + Number(leavingTime[1]) - currentTime.getMinutes()
            document.getElementById("time").innerHTML = currentTime.toLocaleTimeString();
            if (timeLeft > 0) { document.getElementById("timeLeft").innerHTML = `There's still ${Math.floor(timeLeft/60)} h ${timeLeft%60} m ${59 - currentTime.getSeconds()} s left üòÑ!`}
            else { document.getElementById("timeLeft").innerHTML = `What are you still waiting for, isn't it time to leave üòÅ?`; alertOnce(); showToast("Let's Go...‚ùó‚ùó","<h2>üîî</h2>") }
        }
        function validateLunch() {
            let lunchTotal = Number(document.getElementById("lunchTotal").value)
            let workTotal = Number(document.getElementById("targetHrs").value)*60 + Number(document.getElementById("targetMin").value)
            let start = document.getElementById("startTime").value.split(":")
            document.getElementById("suggestLunch").innerHTML = `Recommended to start Lunch in between ${timeCorrecter(Number(start[0])+3)[0]}:${start[1]} and ${timeCorrecter(Number(start[0])+5)[0]}:${start[1]}`
            let lunch = document.getElementById("lunchStart").value.split(":")
            let diff = Number(lunch[0])*60 + Number(lunch[1]) - Number(start[0])*60 - Number(start[1])
            if (lunchTotal < 30 && (workTotal > 360 || (lunchTotal > 0 && workTotal <= 360))) { return showWarning("Usually Lunch can't be less than 30 min. Unless you're waiving it for some reason üßê. Please update Lunch 'Total' as 0 if you'll only work 6 hrs or less and skip lunch üòÖ!") }
            if (diff < 0) { return showWarning("Lunch should start after your Office entry time üòí!") }
            if (diff > 300 && workTotal > 360) { return showWarning(`Lunch should start within 5 hrs from entry of your office üßê. Your current difference is ${Math.floor(diff/60)} hrs ${(diff%60).toString().padStart(2,0)} min ü•±. Unless you're waving your lunch time and only working for max 6 hrs today!`) }
            if (diff < 180) { return showWarning(`It's recommended to start Lunch at least after 3 hrs from entry of your office üßê. Your current difference is only ${Math.floor(diff/60)} hrs ${(diff%60).toString().padStart(2,0)} min üòë`) }
            return hideWarning()
        }
        function changeTotal(th) {
            const startEle = document.getElementById("lunchStart")
            const endEle = document.getElementById("lunchEnd")
            let start = startEle.value.split(":")
            let end = endEle.value.split(":")
            const totalEle = document.getElementById("lunchTotal")
            let total = (Number(end[0]) - Number(start[0]))*60 - Number(start[1]) + Number(end[1])
            if (total > 180) { 
                showToast("Total duration of lunch cannot be greater than 3 hrs = 180 min üòë!"); 
                return endEle.value = (Number(start[0])+3).toString().padStart(2,0) + ":" + start[1]
            }
            if (total < 0) { 
                showToast("You cannot end lunch before you can start your lunch üòí!"); 
                endEle.value = (Number(start[0])).toString().padStart(2,0) + ":" + start[1]
                total = 0
            }             
            totalEle.value = total 
            calLeaveTime()
        }
        function changeTo(th) {
            let start = document.getElementById("lunchStart").value.split(":")
            let total = Number(document.getElementById("lunchTotal").value)
            let min = Number(start[1]) + total
            let hrs = timeCorrecter( Number(start[0]) + Math.floor(min/60) )
            document.getElementById("lunchEnd").value = hrs[0].toString().padStart(2,0) + ":" + (min%60).toString().padStart(2,0)
            time24("lunchEnd", null, hrs[1])
            validateLunch()
        }
        function calLeaveTime() {
            const startEle = document.getElementById("startTime")
            const targetHrsEle = document.getElementById("targetHrs")
            const targetMinEle = document.getElementById("targetMin")
            const lunchTotalEle = document.getElementById("lunchTotal")
            const leavingTimeEle = document.getElementById("leavingTime")
            let start = startEle.value.split(":")
            let min = Number(start[1]) + Number(targetMinEle.value) + Number(lunchTotalEle.value)
            let hrs = timeCorrecter( Number(start[0]) + Number(targetHrsEle.value) + Math.floor(min/60) )
            console.log(hrs);
            leavingTimeEle.value = hrs[0].toString().padStart(2,0) + ":" + (min%60).toString().padStart(2,0)
            time24("leavingTime", null, hrs[1])
            validateLunch()
        }
        function time24(id, th, tomorrow = "") { 
            const hmEle = document.getElementById(id)
            let hm = hmEle.value.split(':')
            if (hm.length !== 2 || isNaN(hm[0]) || isNaN(hm[1]) || Number(hm[0]) > 23 || Number(hm[0]) < 0 || Number(hm[1]) > 59 || Number(hm[1]) < 0) {
                hmEle.value = th.previousValue || "00:00"
                showToast("Seriously üòí? Use arrows ‚¨ÜÔ∏è‚¨áÔ∏è or click on üïí to change time. Only enter valid inputs.")
            }
            document.getElementById(id+'-24').innerHTML = hmEle.value + " Military time" + tomorrow 
        }
        function resetAll() {
            document.getElementById("startTime").value = "08:00"
            document.getElementById("startTime-24").innerHTML = "08:00 Military time"
            document.getElementById("targetHrs").value = "8"
            document.getElementById("targetMin").value = "00"
            document.getElementById("lunchTotal").value = "30"
            document.getElementById("lunchStart").value = "12:00"
            document.getElementById("lunchStart-24").innerHTML = "12:00 Military time"
            document.getElementById("lunchEnd").value = "12:30"
            document.getElementById("lunchEnd-24").innerHTML = "12:30 Military time"
            document.getElementById("leavingTime").value = "16:30"
            document.getElementById("leavingTime-24").innerHTML = "16:30 Military time"
        }
    </script>

</body>
</html>
